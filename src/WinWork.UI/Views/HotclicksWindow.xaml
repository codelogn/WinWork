<Window x:Class="WinWork.UI.Views.HotclicksWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:WinWork.UI.ViewModels"
        xmlns:system="clr-namespace:System;assembly=mscorlib"
        mc:Ignorable="d"
        Title="Hotclicks" Height="600" Width="900" WindowStartupLocation="CenterScreen"
        AllowsTransparency="True"
        WindowStyle="None"
        Background="Transparent"
        ShowInTaskbar="True"
        ResizeMode="CanResize">

    <Border x:Name="MainBorder"
            Background="#E6000000" 
            CornerRadius="12" 
            BorderBrush="#33FFFFFF" 
            BorderThickness="1"
            Padding="12">
        
        <!-- Window Chrome Effect -->
        <Border.Effect>
            <DropShadowEffect BlurRadius="20" 
                              ShadowDepth="0" 
                              Color="Black" 
                              Opacity="0.3"/>
        </Border.Effect>
        
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="40"/> <!-- Title Bar -->
                <RowDefinition Height="*"/>  <!-- Content -->
            </Grid.RowDefinitions>
            
            <!-- Custom Title Bar -->
            <Border Grid.Row="0" 
                    Background="#33FFFFFF" 
                    CornerRadius="12,12,0,0"
                    MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Title -->
                    <TextBlock Grid.Column="0"
                               Text="Hotclicks"
                               Foreground="White"
                               FontSize="14"
                               FontWeight="Medium"
                               VerticalAlignment="Center"
                               Margin="16,0,0,0"/>
                    
                    <!-- Window Controls -->
                    <StackPanel Grid.Column="1" 
                                Orientation="Horizontal">
                        
                        <!-- Minimize Button -->
                        <Button x:Name="MinimizeButton"
                                Content="ðŸ—•"
                                Style="{StaticResource WindowControlButtonStyle}"
                                Click="MinimizeButton_Click"/>
                        
                        <!-- Maximize Button -->
                        <Button x:Name="MaximizeButton"
                                Content="{Binding RelativeSource={RelativeSource Self}, Path=Tag}"
                                Tag="ðŸ—–"
                                Style="{StaticResource WindowControlButtonStyle}"
                                Click="MaximizeButton_Click"/>
                        
                        <!-- Close Button -->
                        <Button x:Name="CloseButton"
                                Content="âœ•"
                                Click="CloseButton_Click">
                            <Button.Style>
                                <Style TargetType="Button" BasedOn="{StaticResource WindowControlButtonStyle}">
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#E81123"/>
                                        </Trigger>
                                        <Trigger Property="IsPressed" Value="True">
                                            <Setter Property="Background" Value="#C50E1F"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>
            
            <!-- Content Area -->
            <DockPanel Grid.Row="1" Margin="12">
                <!-- Header with search and buttons -->
                <StackPanel DockPanel.Dock="Top" Margin="0,0,0,12">
                <!-- Title and Buttons Row -->
                <Grid Margin="0,0,0,12">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock Grid.Column="0" Text="Hotclick Items" 
                               Foreground="White" FontSize="20" FontWeight="Bold" 
                               VerticalAlignment="Center"/>
                    
                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                        <Button Content="Refresh" Command="{Binding RefreshCommand}" 
                                Style="{StaticResource ModernButtonStyle}" Margin="0,0,8,0"/>
                        <Button Content="Open All" Command="{Binding OpenAllCommand}" 
                                Style="{StaticResource ModernButtonStyle}"/>
                    </StackPanel>
                </Grid>
                
                <!-- Search Box -->
                <Grid>
                    <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                             Padding="32,8,12,8"
                             Background="#33FFFFFF"
                             Foreground="White"
                             BorderBrush="#66FFFFFF"
                             BorderThickness="1"
                             FontSize="14"
                             Height="36"/>
                    <TextBlock Text="Search:" 
                               Foreground="#99FFFFFF"
                               FontSize="14"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Left"
                               Margin="10,0,0,0"
                               IsHitTestVisible="False"/>
                    <TextBlock Text="Search hotclick tags..."
                               Foreground="#99FFFFFF"
                               FontSize="14"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Left"
                               Margin="32,0,0,0"
                               IsHitTestVisible="False">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Visibility" Value="Collapsed"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding SearchText}" Value="">
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding SearchText}" Value="{x:Null}">
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                </Grid>
            </StackPanel>

            <!-- Main Content with Two Panels -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="3"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Left Panel - Tags -->
                <Border Grid.Column="0" Background="#19FFFFFF" CornerRadius="8" Padding="8">
                    <DockPanel>
                        <TextBlock DockPanel.Dock="Top" Text="ðŸ·ï¸ Tags" 
                                   Foreground="White" FontSize="14" FontWeight="Bold" 
                                   Margin="0,0,0,8"/>
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <ListBox ItemsSource="{Binding HotclickTags}" 
                                     SelectedItem="{Binding SelectedTag}"
                                     Background="Transparent" 
                                     BorderThickness="0">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Margin="4">
                                            <TextBlock Text="ðŸ·ï¸" Margin="0,0,4,0" Foreground="#99FFFFFF"/>
                                            <TextBlock Text="{Binding}" Foreground="White"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                                <ListBox.ItemContainerStyle>
                                    <Style TargetType="ListBoxItem">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="BorderThickness" Value="0"/>
                                        <Setter Property="Padding" Value="8,4"/>
                                        <Setter Property="Margin" Value="0,1"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="ListBoxItem">
                                                    <Border Background="{TemplateBinding Background}"
                                                            BorderBrush="{TemplateBinding BorderBrush}"
                                                            BorderThickness="{TemplateBinding BorderThickness}"
                                                            Padding="{TemplateBinding Padding}"
                                                            CornerRadius="4">
                                                        <ContentPresenter/>
                                                    </Border>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#33FFFFFF"/>
                                            </Trigger>
                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter Property="Background" Value="#4D6B46C1"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </ListBox.ItemContainerStyle>
                            </ListBox>
                        </ScrollViewer>
                    </DockPanel>
                </Border>

                <!-- Splitter -->
                <GridSplitter Grid.Column="1" 
                              Background="#33FFFFFF"
                              HorizontalAlignment="Stretch"
                              VerticalAlignment="Stretch"/>

                <!-- Right Panel - Items for Selected Tag -->
                <Border Grid.Column="2" Background="#19FFFFFF" CornerRadius="8" Padding="8">
                    <DockPanel>
                        <TextBlock DockPanel.Dock="Top" 
                                   Foreground="White" FontSize="14" FontWeight="Bold" 
                                   Margin="0,0,0,8">
                            <TextBlock.Text>
                                <MultiBinding StringFormat="ðŸ“„ Items in '{0}'">
                                    <Binding Path="SelectedTag" FallbackValue="No Tag Selected"/>
                                </MultiBinding>
                            </TextBlock.Text>
                        </TextBlock>
                        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                            <ListView ItemsSource="{Binding SelectedTagItems}" 
                                      Background="Transparent" 
                                      Foreground="White" 
                                      BorderThickness="0">
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn Header="Name" DisplayMemberBinding="{Binding Name}" Width="200"/>
                                        <GridViewColumn Header="Type" DisplayMemberBinding="{Binding Link.Type}" Width="100"/>
                                        <GridViewColumn Header="Description" DisplayMemberBinding="{Binding Link.Description}" Width="150"/>
                                        <GridViewColumn Header="Command/URL" Width="200">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <TextBlock TextTrimming="CharacterEllipsis">
                                                        <TextBlock.Style>
                                                            <Style TargetType="TextBlock">
                                                                <Setter Property="Text" Value="{Binding Link.Command}"/>
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding Link.Command}" Value="">
                                                                        <Setter Property="Text" Value="{Binding Link.Url}"/>
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding Link.Command}" Value="{x:Null}">
                                                                        <Setter Property="Text" Value="{Binding Link.Url}"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </TextBlock.Style>
                                                    </TextBlock>
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                    </GridView>
                                </ListView.View>
                            </ListView>
                        </ScrollViewer>
                    </DockPanel>
                </Border>
                </Grid>
            </DockPanel>
        </Grid>
    </Border>
</Window>
